{% extends "mlt_job.html" %}
{% from "helper.html" import serve_file %}

{% block job_content %}
{% set task = job.train_task() %}
<style>
    .distribution-graph g.c3-axis-x g.tick {
        display: none;
    }
</style>
<script>
    function drawDistributionGraph(task_id, data) {
        var selector = "#"+task_id+" .distribution-graph";
        $(selector).show();
        c3.generate($.extend(true, data, {
            bindto: selector,
            axis: {
                x: {
                    label: {
                        text: 'Category',
                        position: 'outer-center',
                    },
                    tick: {
                        culling: true,
                    },
                },
                y: {
                    label: {
                        text: 'Image Count',
                        position: 'outer-middle',
                        min: 0,
                    }
                }
            },
            legend: {show: false},
        }));
    }
    function displayMeanImage(task_id, url) {
        $("#"+task_id+" img.mean-image").attr("src", url);
        $("#"+task_id+" div.mean-image").show();
    }
    function showExplorationLink(task_id) {
        $("#"+task_id+" div.exploration").show();
    }
</script>

{% if job.parse_folder_tasks()|length == 1 %}
{% set task = job.parse_folder_tasks()[0] %}
<div class="row">
    <div class="col-sm-6">
        <div id="job-information" class="panel panel-default">
            {{ print_job_information() }}
        </div>
    </div>
    <div class="col-sm-6">
        <div id="{{task.html_id()}}" class="panel panel-default">
            {{ print_parse_folder_task(task) }}
        </div>
    </div>
</div>
{% else %}
<div class="row">
    <div class="col-sm-6 col-sm-offset-3">
        <div id="job-information" class="panel panel-default">
            {{ print_job_information() }}
        </div>
    </div>
</div>
{% if job.parse_folder_tasks()|length == 2 %}
<div class="row">
    {% set task = job.parse_folder_tasks()[0] %}
    <div class="col-sm-6">
        <div id="{{task.html_id()}}" class="panel panel-default">
            {{ print_parse_folder_task(task) }}
        </div>
    </div>
    {% set task = job.parse_folder_tasks()[1] %}
    <div class="col-sm-6">
        <div id="{{task.html_id()}}" class="panel panel-default">
            {{ print_parse_folder_task(task) }}
        </div>
    </div>
</div>
{% elif job.parse_folder_tasks()|length == 3 %}
<div class="row">
    {% set task = job.parse_folder_tasks()[0] %}
    <div class="col-sm-4">
        <div id="{{task.html_id()}}" class="panel panel-default">
            {{ print_parse_folder_task(task) }}
        </div>
    </div>
    {% set task = job.parse_folder_tasks()[1] %}
    <div class="col-sm-4">
        <div id="{{task.html_id()}}" class="panel panel-default">
            {{ print_parse_folder_task(task) }}
        </div>
    </div>
    {% set task = job.parse_folder_tasks()[2] %}
    <div class="col-sm-4">
        <div id="{{task.html_id()}}" class="panel panel-default">
            {{ print_parse_folder_task(task) }}
        </div>
    </div>
</div>
{% endif %}
{% endif %}

{% for task in job.create_db_tasks() %}
<div class="row">
    <div class="col-sm-12">
        <div id="{{task.html_id()}}" class="panel panel-default">
            {{ print_create_db_task(task) }}
        </div>
    </div>
</div>
{% endfor %}

{% endblock %}
